<!DOCTYPE busconfig PUBLIC
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>
  <!-- Only root can own the service -->
  <policy user="root">
    <allow own="tech.geektoshi.waypoint"/>
  </policy>

  <!-- Allow any user to call methods (authorization handled by Polkit) -->
  <policy context="default">
    <!-- Allow calls to the main Helper interface -->
    <allow send_destination="tech.geektoshi.waypoint"
           send_interface="tech.geektoshi.waypoint.Helper"/>

    <!-- Allow standard D-Bus interfaces -->
    <allow send_destination="tech.geektoshi.waypoint"
           send_interface="org.freedesktop.DBus.Introspectable"/>
    <allow send_destination="tech.geektoshi.waypoint"
           send_interface="org.freedesktop.DBus.Properties"/>
    <allow send_destination="tech.geektoshi.waypoint"
           send_interface="org.freedesktop.DBus.Peer"/>
  </policy>
</busconfig>
